---
- block: # browser is defined
  - name: Install Chromium browser
    include_tasks: chromium.yml
    when: "'chromium' in browsers"
  - name: Install Google Chrome
    include_tasks: chrome.yml
    when: "'chrome' in browsers"
  - name: Ensure web browser is installed
    package: name={{ item }} state=present
    with_items:
      "{{ browsers | difference(['chrome', 'chromium', 'edge', 'firefox_without_snap']) | list }}"
    become: "{{ false_for_macos }}"
  - name: Install non snap version of Firefox
    include_tasks: firefox_without_snap.yml
    when: "'firefox_without_snap' in browsers"
  - name: Ensure Microsoft Edge is installed on macOS hosts
    homebrew_cask:
      name: microsoft-edge
      sudo_password: "{{ ansible_become_pass }}"
    when: "'edge' in browsers and ansible_system == 'Darwin'"
  when: browsers is defined
